webpackJsonp([4],{L8vA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={components:{ElSelectTree:i("2Yd0").a},name:"shrekGoods",data:function(){return{form:{title:void 0,intro:void 0,price:void 0,deleteStatues:void 0,categoryId:"",sctionId:"",imgPath:""},form2:{type:"",imgsrc:"",goodsid:"",deleteStatus:"1"},typeOptions:[{id:1,lable:"轮播"},{id:2,lable:"详情"}],rules:{title:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],intro:[{required:!0,message:"请输入介绍",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],price:[{required:!0,message:"请输入",trigger:"blur"}],deleteStatues:[{required:!0,message:"请输入",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]},list:null,totalCount:null,listLoading:!0,listQuery:{pageNum:1,pageRow:20,name:void 0},dialogFormVisible:!1,dialogFormVisible2:!1,searchzone:!0,addzone:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建"},tableKey:0,listCategory:[],listSction:[],forbidden:!1,uploadUrl:"api/shrekGoods/singlefile",imageUrl:"",listImage:[],goodsId:""}},created:function(){this.getList(),this.getlistCategory(),this.getlistSction()},methods:{getList:function(){var t=this;this.listLoading=!0,this.api({url:"/shrekGoods",method:"get"}).then(function(e){t.listLoading=!1,t.list=e.list,t.totalCount=e.totalCount})},getlistCategory:function(){var t=this;this.listLoading=!0,this.api({url:"/shrekCategory/selectList",method:"get"}).then(function(e){t.listCategory=e})},getlistSction:function(){var t=this;this.listLoading=!0,this.api({url:"/shrekSction/selectList",method:"get"}).then(function(e){t.listSction=e})},handleFilter:function(){this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},addImg:function(){this.searchzone=!1,this.addzone=!0},getImgList:function(t){this.dialogFormVisible2=!0,this.searchzone=!0,this.addzone=!1,this.goodsId=t,this.form2.goodsid=t,this.getImgList1()},getImgList1:function(){var t=this;this.api({url:"/shrekGoodsImg",method:"get",params:{goodsId:this.goodsId}}).then(function(e){t.listImage=e.list})},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleCreate:function(){this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(t){this.form=t,this.imageUrl=t.imgPath,this.dialogFormVisible=!0,this.dialogStatus="update"},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.api({url:"/shrekGoods?id="+t.id,method:"delete"}).then(function(){e.getList()}).catch(function(){e.$message.error("删除失败")})})},create:function(t){var e=this,i=this.$refs;this.form.deleteStatus="1",i[t].validate(function(t){if(!t)return!1;e.api({url:"shrekGoods",method:"post",data:e.form}).then(function(){e.getList(),e.dialogFormVisible=!1})})},createImg:function(){var t=this,e=this;this.api({url:"shrekGoodsImg",method:"post",data:this.form2}).then(function(){e.getImgList(t.goodsId)})},cancel:function(t){this.dialogFormVisible=!1},handleAvatarPreview:function(){this.dialogImageUrl=file.url,this.dialogVisible=!0},handleAvatarSuccess:function(t,e){this.imageUrl="api/images/"+t.returnData,this.form.imgPath="api/images/"+t.returnData},handleAvatarSuccess2:function(t,e){this.imageUrl="api/images/"+t.returnData,this.form2.imgsrc="api/images/"+t.returnData},handleAvatarRemove:function(t){},beforeAvatarRemove:function(t){if("success"==t.status)return this.$confirm("是否确定删除该图片？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",cancelButtonClass:"el-button--danger",confirmButtonClass:"el-button--success"})},beforeAvatarUpload:function(t){var e=!0,i=t.name.substring(t.name.lastIndexOf(".")+1),a=t.size/1024/1024<2;return 0==t.size&&(e=!1,this.$message.error("上传头像图片大小不能 0 KB!")),"jpg"!==i&&"jpeg"!==i&&"png"!==i&&"gif"!==i&&"bmp"!==i&&"JPG"!==i&&"JPEG"!==i&&"PNG"!==i&&"GIF"!==i&&"BMP"!==i&&(e=!1,this.$message.error("上传图片格式为 jpg、jpeg、png、gif、bmp格式!")),a||this.$message.error("上传图片大小不能超过 2MB!"),e&&a},update:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.api({url:"shrekGoods",method:"put",data:e.form}).then(function(){e.getList(),e.dialogFormVisible=!1})})},resetTemp:function(){this.form={}}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"姓名或账户"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.handleFilter(e)}},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}}),t._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:t.handleCreate}},[t._v("添加")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{width:"200px",align:"center",label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.title))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"介绍"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.intro))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"200px",align:"center",label:"价格"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.price))])]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"success"},on:{click:function(i){t.handleUpdate(e.row)}}},[t._v("编辑\n      ")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){t.handleDelete(e.row)}}},[t._v("删除\n      ")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"success"},on:{click:function(i){t.getImgList(e.row.id)}}},[t._v("图片管理\n        ")])]}}])})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":t.listQuery.pageNum,"page-sizes":[10,20,30,50],"page-size":t.listQuery.pageRow,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"pageNum",e)}}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"商品名称",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"介绍",prop:"intro"}},[i("el-input",{attrs:{placeholder:"请输入介绍"},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"价格",prop:"price"}},[i("el-input",{attrs:{placeholder:"请输入"},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"图片",prop:"price"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?i("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),i("el-form-item",{attrs:{label:"分类",required:""}},[i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},t._l(t.listCategory,function(t){return i("el-option",{key:t.id,attrs:{label:t.categoryName,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"栏位",required:""}},[i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.form.sctionId,callback:function(e){t.$set(t.form,"sctionId",e)},expression:"form.sctionId"}},t._l(t.listSction,function(t){return i("el-option",{key:t.id,attrs:{label:t.sectionName,value:t.id}})}))],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.cancel("form")}}},[t._v("取 消")]),t._v(" "),"create"==t.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.create("form")}}},[t._v("确 定")]):i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.update("form")}}},[t._v("确 定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogFormVisible2},on:{"update:visible":function(e){t.dialogFormVisible2=e}}},[t.searchzone?i("el-row",[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"edit"},on:{click:t.addImg}},[t._v("添加")])],1),t._v(" "),i("el-table",{attrs:{data:t.listImage,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",prop:"type",label:"类型1"}}),t._v(" "),i("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",prop:"imgsrc",label:"图片"}})],1)],1):t._e(),t._v(" "),t.addzone?i("el-row",[i("el-form",{ref:"form",attrs:{model:t.form2,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"类别",prop:"price"}},[i("el-select",{attrs:{placeholder:"请选择",disabled:t.forbidden},model:{value:t.form2.type,callback:function(e){t.$set(t.form2,"type",e)},expression:"form2.type"}},t._l(t.typeOptions,function(t){return i("el-option",{key:t.id,attrs:{label:t.lable,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"图片",prop:"price"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,"show-file-list":!1,"on-success":t.handleAvatarSuccess2,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?i("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),i("el-form-item",[i("el-button",{on:{click:function(e){t.cancel("form")}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.createImg("form2")}}},[t._v("确 定")])],1)],1)],1):t._e()],1)],1)},staticRenderFns:[]};var o=i("VU/8")(a,r,!1,function(t){i("aQBa")},null,null);e.default=o.exports},O1WS:function(t,e,i){(t.exports=i("FZ+f")(!0)).push([t.i,"\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n","",{version:3,sources:["D:/shrekspringboot/backpage/src/views/shrekGoods/index.vue"],names:[],mappings:";AACA;EACE,2BAA2B;EAC3B,mBAAmB;EACnB,gBAAgB;EAChB,mBAAmB;EACnB,iBAAiB;CAClB;AACD;EACE,sBAAsB;CACvB;AACD;EACE,gBAAgB;EAChB,eAAe;EACf,aAAa;EACb,cAAc;EACd,mBAAmB;EACnB,mBAAmB;CACpB;AACD;EACE,aAAa;EACb,cAAc;EACd,eAAe;CAChB",file:"index.vue",sourcesContent:["\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n"],sourceRoot:""}])},aQBa:function(t,e,i){var a=i("O1WS");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("c8679524",a,!0)}});